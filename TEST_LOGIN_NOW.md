# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞ - –°–ï–ô–ß–ê–°

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. ‚úÖ –ò–∑–º–µ–Ω–µ–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å `router.push()` –Ω–∞ `window.location.href` –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
2. ‚úÖ –£–ø—Ä–æ—â–µ–Ω middleware - —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ cookie
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö
4. ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `window.location.href` –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤

## –®–∞–≥–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

### 1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
npm run dev
```

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:3000/admin/login`
2. –ù–∞–∂–º–∏—Ç–µ `F12` –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è DevTools
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Console**

### 3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏

–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email –∏ –ø–∞—Ä–æ–ª—å, –Ω–∞–∂–º–∏—Ç–µ "–£–≤—ñ–π—Ç–∏".

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:**

```
üîê –°–ø—Ä–æ–±–∞ –≤—Ö–æ–¥—É... { email: "–≤–∞—à-email" }
‚úÖ Supabase auth —É—Å–ø—ñ—à–Ω–∞: user-id
üì° –í—ñ–¥–ø–æ–≤—ñ–¥—å API: 200
üì¶ –î–∞–Ω—ñ API: { success: true, ... }
‚úÖ –£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥, —Ä–µ–¥—ñ—Ä–µ–∫—Ç –Ω–∞ /admin
```

**–ó–∞—Ç–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∏ –æ—Ç–∫—Ä—ã—Ç—å—Å—è `/admin`**

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /admin

–ü–æ—Å–ª–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:

```
üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó...
üìã –°–µ—Å—ñ—è: { session: true, error: null }
‚úÖ –°–µ—Å—ñ—è –∑–Ω–∞–π–¥–µ–Ω–∞, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞...
üë§ User ID: –≤–∞—à-user-id
üìä –ü—Ä–æ—Ñ—ñ–ª—å: { profile: { is_admin: true }, error: null }
‚úÖ –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö...
```

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ (—Ç–µ—Ä–º–∏–Ω–∞–ª)

–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `npm run dev`, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```
üîì Middleware: –¥–æ—Å—Ç—É–ø –¥–æ /admin/login –¥–æ–∑–≤–æ–ª–µ–Ω–æ
üîç Middleware: –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ /admin
üç™ –ó–Ω–∞–π–¥–µ–Ω–æ Supabase cookies: 1
‚úÖ Middleware: —Ç–æ–∫–µ–Ω –∑–Ω–∞–π–¥–µ–Ω–æ, –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ
```

## –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –ü—Ä–æ–±–ª–µ–º–∞: –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+Delete)
2. –û—á–∏—Å—Ç–∏—Ç–µ cookies –¥–ª—è localhost
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ–º–∞—î —Å–µ—Å—ñ—ó" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /admin

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /admin/login
// –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Å—Å–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
const { data } = await supabase.auth.getSession();
console.log('Session:', data.session);
```

–ï—Å–ª–∏ `session` null - –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–µ—Å—Å–∏–∏.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ cookies –≤ DevTools ‚Üí Application ‚Üí Cookies
2. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å cookie —Å –∏–º–µ–Ω–µ–º `sb-uugsiyattuabotlmegfe-auth-token`
3. –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç - –ø—Ä–æ–±–ª–µ–º–∞ —Å Supabase –∫–ª–∏–µ–Ω—Ç–æ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é"

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –í Supabase SQL Editor
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ—Ñ–∏–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
SELECT * FROM public.profiles WHERE email = '–≤–∞—à-email@example.com';

-- –ï—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ –≤—Ä—É—á–Ω—É—é
INSERT INTO public.profiles (id, email, is_admin)
SELECT id, email, true
FROM auth.users
WHERE email = '–≤–∞—à-email@example.com';
```

### –ü—Ä–æ–±–ª–µ–º–∞: Middleware —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –ª–æ–≥–∏–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ middleware –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
2. –ï—Å–ª–∏ –ø–∏—à–µ—Ç "–Ω–µ–º–∞—î auth —Ç–æ–∫–µ–Ω–∞" - –ø—Ä–æ–±–ª–µ–º–∞ —Å cookies
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å middleware –≤—Ä–µ–º–µ–Ω–Ω–æ:

```typescript
// –í src/middleware.ts
export const config = {
    matcher: [], // –û—Ç–∫–ª—é—á–∞–µ–º middleware
};
```

## –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/admin/login` –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞:

```javascript
// 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏
const { data: { session } } = await supabase.auth.getSession();
console.log('Session exists:', !!session);
console.log('User ID:', session?.user?.id);

// 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è
if (session) {
    const { data: profile, error } = await supabase
        .from('profiles')
        .select('*')
        .eq('id', session.user.id)
        .single();
    
    console.log('Profile:', profile);
    console.log('Is admin:', profile?.is_admin);
    console.log('Error:', error);
}

// 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ cookies
console.log('Cookies:', document.cookie);
```

## –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä
# 2. –£–¥–∞–ª–∏—Ç–µ .next
rm -rf .next  # –∏–ª–∏ rmdir /s /q .next –Ω–∞ Windows

# 3. –û—á–∏—Å—Ç–∏—Ç–µ node_modules (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
rm -rf node_modules
npm install

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
npm run dev
```

–í –±—Ä–∞—É–∑–µ—Ä–µ:
1. –û—á–∏—Å—Ç–∏—Ç–µ –≤—Å–µ cookies –¥–ª—è localhost
2. –ó–∞–∫—Ä–æ–π—Ç–µ –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏ —Å localhost
3. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ —Å–Ω–æ–≤–∞

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤—ã –¥–æ–ª–∂–Ω—ã:
1. ‚úÖ –£–≤–∏–¥–µ—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É `/admin` —Å –ø–∞–Ω–µ–ª—å—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. ‚úÖ –í–∏–¥–µ—Ç—å –∑–∞–∫–∞–∑—ã, —Ç–æ–≤–∞—Ä—ã, –ø—Ä–æ–º–æ–∫–æ–¥—ã
3. ‚úÖ –ö–Ω–æ–ø–∫–∞ "–í–∏–π—Ç–∏" –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å
4. ‚úÖ –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–∫—Ä—ã—Ç—å `/admin` –±–µ–∑ –≤—Ö–æ–¥–∞ - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/admin/login`
